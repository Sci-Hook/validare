import {response_type} from './types/response';
import {codes} from './codes';
import {Response} from 'express';

export function response(res:Response,options:response_type) {

    var code:number;
    var status:boolean;
    var message:string|undefined;

    if (typeof options.code == 'string') {
        code = codes[options.code];
    }else{
        code = options.code;
    }

    if (typeof options.status === 'undefined') {
        if (code < 400) {status = true;}else{status = false}
    }else{status = options.status};

    if (options.msg) {
        if (res.locals.i18n) {
            if (res.locals.i18n.messages[options.msg]) {
                message = res.locals.i18n.messages[options.msg];
            }else{
                message = options.msg
            }
        }
    }
    
    res.status(code).json({
        status,
        code,
        message,
        version:options.version,
        redirect:options.redirect,
        data:options.data
    });

}